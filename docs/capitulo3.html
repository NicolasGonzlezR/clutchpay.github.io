<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cap√≠tulo 3: API REST y Login - ClutchPay</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <div class="container">
            <h1>üí∞ ClutchPay</h1>
            <p class="subtitle">Cap√≠tulo 3: API REST y Login</p>
        </div>
    </header>

    <nav class="main-nav">
        <div class="container">
            <a href="index.html">Inicio</a>
            <a href="capitulo3.html" class="active">Cap√≠tulo 3</a>
        </div>
    </nav>

    <main class="container">
        <div class="back-nav">
            <a href="index.html" class="back-btn">‚Üê Volver al √≠ndice</a>
        </div>

        <div class="chapter-content">
            <div class="chapter-header">
                <h1>Cap√≠tulo 3: API REST y Login</h1>
            </div>

            <div class="video-embed">
                <iframe
                    src="https://drive.google.com/file/d/1BTh_bb3FTOXluSeu1g4q2U1_BQKS57rX/preview"
                    title="Video tutorial - Cap√≠tulo 3"
                    allow="autoplay; encrypted-media"
                    allowfullscreen
                ></iframe>
            </div>

            <div class="content-section">
                <h2>üìñ Contenido Completo</h2>
                <div class="markdown-body">
                    <h1>Configuraci√≥n de Autenticaci√≥n y Base de Datos en ClutchPay</h1>
                    <p>En este tutorial se guiar√° paso a paso para configurar todo el sistema de autenticaci√≥n y la conexi√≥n a la base de datos de ClutchPay.</p>
                    
                    <ol>
                        <li>
                            <strong>Instalaci√≥n de dependencias</strong><br>
                            Comenzaremos instalando varias librer√≠as esenciales:
                            <ul>
                                <li>NextAuth para manejar la autenticaci√≥n.</li>
                                <li>Una librer√≠a de cifrado para proteger las contrase√±as.</li>
                                <li>Zod junto a una librer√≠a de validaci√≥n de tel√©fonos para asegurarnos de que los datos del usuario siempre sean correctos.</li>
                            </ul>
                        </li>
                        <li>
                            <strong>Creaci√≥n del cliente de Prisma</strong><br>
                            Despu√©s configuraremos el cliente de Prisma. Se exportar√° este cliente para usarlo desde cualquier parte de la aplicaci√≥n sin problemas.
                        </li>
                        <li>
                            <strong>Validaciones de datos con Zod</strong><br>
                            Antes de permitir que los usuarios se registren, es fundamental validar toda la informaci√≥n que env√≠an. En esta secci√≥n veremos:
                            <ul>
                                <li>C√≥mo validar correos electr√≥nicos.</li>
                                <li>C√≥mo asegurar contrase√±as fuertes siguiendo varios criterios.</li>
                                <li>C√≥mo corregir, formatear y validar n√∫meros de tel√©fono internacionales.</li>
                                <li>Y c√≥mo preparar un validador completo para un usuario nuevo.</li>
                            </ul>
                        </li>
                        <li>
                            <strong>Configuraci√≥n de NextAuth</strong><br>
                            A continuaci√≥n configuraremos el sistema de autenticaci√≥n.
                            <ul>
                                <li>Se explicar√° c√≥mo funciona el proveedor de credenciales, que permite iniciar sesi√≥n usando email y contrase√±a.</li>
                                <li>C√≥mo se verifica la existencia de un usuario.</li>
                                <li>C√≥mo se comprueba su contrase√±a comparando el hash almacenado.</li>
                                <li>C√≥mo se agregan datos personalizados dentro del token JWT.</li>
                                <li>Y c√≥mo estos datos se exponen en la sesi√≥n disponible en el cliente.</li>
                            </ul>
                        </li>
                        <li>
                            <strong>Extender los tipos de NextAuth</strong><br>
                            En este punto veremos c√≥mo a√±adir propiedades personalizadas al usuario y a la sesi√≥n, para que todo est√© correctamente tipado tanto en el backend como en el frontend.
                        </li>
                        <li>
                            <strong>Creaci√≥n de rutas de autenticaci√≥n</strong><br>
                            Luego configuraremos las rutas de API que manejar√°n:
                            <ul>
                                <li>Todo el flujo de NextAuth (inicio de sesi√≥n, cierre de sesi√≥n, callbacks, etc).</li>
                                <li>Un endpoint independiente para registrar nuevos usuarios.</li>
                            </ul>
                            Se explicar√° c√≥mo funciona el proceso de registro completo:
                            <ul>
                                <li>Validar los datos enviados.</li>
                                <li>Verificar si el correo ya est√° registrado.</li>
                                <li>Cifrar la contrase√±a antes de guardarla.</li>
                                <li>Manejar errores comunes como duplicaci√≥n de usuarios.</li>
                                <li>Responder al cliente sin exponer datos sensibles.</li>
                            </ul>
                        </li>
                        <li>
                            <strong>Variables de entorno</strong><br>
                            Aqu√≠ prepararemos las variables esenciales para:
                            <ul>
                                <li>La conexi√≥n a la base de datos.</li>
                                <li>La URL de NextAuth.</li>
                                <li>Y la clave secreta para firmar los tokens JWT.</li>
                            </ul>
                            Tambi√©n se mostrar√° c√≥mo generar un secreto seguro para producci√≥n.
                        </li>
                        <li>
                            <strong>Inicializaci√≥n de Prisma</strong>
                            <ul>
                                <li>Despu√©s se inicializar√° Prisma generando el cliente y creando las tablas en la base de datos.</li>
                                <li>Adem√°s, veremos c√≥mo abrir Prisma Studio para visualizar los datos de manera gr√°fica.</li>
                            </ul>
                        </li>
                        <li>
                            <strong>Pruebas b√°sicas con registro e inicio de sesi√≥n</strong><br>
                            Para finalizar, se probar√° el flujo completo:
                            <ul>
                                <li>Registraremos un usuario nuevo.</li>
                                <li>Intentaremos iniciar sesi√≥n con √©l.</li>
                                <li>Y verificaremos que el backend devuelve una sesi√≥n v√°lida.</li>
                            </ul>
                            Con estas pruebas confirmaremos que todo est√° funcionando tal como se espera.
                        </li>
                    </ol>
                </div>
            </div>
        </div>

        <div class="chapter-nav">
            <div class="prev">
                <a href="capitulo2.html">
                    <span class="nav-label">‚Üê Anterior</span>
                    <span class="nav-title">Cap√≠tulo 2: Base de Datos</span>
                </a>
            </div>
            <div class="next">
                <a href="capitulo4.html">
                    <span class="nav-label">Siguiente ‚Üí</span>
                    <span class="nav-title">Cap√≠tulo 4: Frontend de Login</span>
                </a>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>üìö Material educativo para aprender desarrollo full-stack moderno</p>
            <p>Basado en el proyecto <a href="https://github.com/GCousido/ClutchPay" target="_blank">ClutchPay</a></p>
        </div>
    </footer>
</body>
</html>