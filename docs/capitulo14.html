<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cap√≠tulo 14: Frontend de Pagos - ClutchPay</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <div class="container">
            <h1>üí∞ ClutchPay</h1>
            <p class="subtitle">Cap√≠tulo 14: Frontend de Pagos</p>
        </div>
    </header>

    <nav class="main-nav">
        <div class="container">
            <a href="index.html">Inicio</a>
            <a href="capitulo14.html" class="active">Cap√≠tulo 14</a>
        </div>
    </nav>

    <main class="container">
        <div class="back-nav">
            <a href="index.html" class="back-btn">‚Üê Volver al √≠ndice</a>
        </div>

        <div class="chapter-content">
            <div class="chapter-header">
                <h1>Cap√≠tulo 14: Frontend de Pagos</h1>
            </div>

            <div class="video-embed">
                <iframe
                    src="https://drive.google.com/file/d/1EwVtZDg7ltEgO4Tw2Q83U4XuEqvJwJJT/preview"
                    title="Video tutorial - Cap√≠tulo 14"
                    allow="autoplay; encrypted-media"
                    allowfullscreen
                ></iframe>
            </div>

            <div class="content-section">
                <h2>üìñ Contenido Completo</h2>
                <div class="markdown-body">
                    <h1>Implementaci√≥n de Nuevas Funcionalidades en el Dashboard de usuario respecto a pagos con Stripe</h1>
                    <p>En este tutorial se describe las modificaciones implementadas en los archivos del proyecto, espec√≠ficamente las referentes a nuevas funcionalidades a√±adidas para la gesti√≥n de pagos, la navegaci√≥n y el manejo de estados de pago.</p>
                    
                    <h2>1. Archivos Modificados</h2>
                    <ul>
                        <li><strong>public/JS/dashboard/invoices.js</strong></li>
                        <li><strong>public/JS/dashboard_usuario.js</strong></li>
                        <li><strong>public/main.html</strong></li>
                    </ul>
                    
                    <h2>2. public/JS/dashboard/invoices.js</h2>
                    <p>En este archivo se han implementado varias modificaciones relacionadas con la gesti√≥n de facturas y pagos. Las nuevas funcionalidades incluyen la carga de informaci√≥n del deudor, la obtenci√≥n del recibo de pago cuando una factura es pagada y la integraci√≥n con el sistema de pagos de Stripe para procesar pagos de facturas. Adem√°s, se maneja la visualizaci√≥n de los detalles relacionados con cada factura.</p>
                    
                    <h3>2.1. Cargar Informaci√≥n del Deudor</h3>
                    <p>Se ha a√±adido una funcionalidad para cargar la informaci√≥n del deudor de una factura, que se obtiene desde la API usando el <code>debtorUserId</code>. Esto se hace en caso de que el usuario quiera ver los detalles del deudor asociado a la factura. La informaci√≥n que se muestra incluye el nombre completo o el correo electr√≥nico del deudor.</p>
                    
                    <h3>2.2. Cargar Recibo de Pago</h3>
                    <p>Cuando la factura tiene el estado <strong>PAID</strong>, se agrega una l√≥gica que permite cargar el recibo de pago asociado. Para esto, el sistema realiza dos solicitudes para obtener los pagos del pagador y del receptor. Si el recibo est√° disponible, se extrae la URL del PDF del recibo para que el usuario pueda consultarlo.</p>
                    
                    <h3>2.3. Manejo de Pago con Stripe</h3>
                    <p>Se ha integrado una funcionalidad que permite a los usuarios pagar las facturas utilizando Stripe. Al hacer clic en el bot√≥n de pago, se crea una sesi√≥n de pago a trav√©s de la API de Stripe. Si el proceso es exitoso, el usuario es redirigido a la p√°gina de pago de Stripe. En caso de error, se muestra un mensaje informando al usuario y el bot√≥n de pago se restaura a su estado original.</p>
                    
                    <h2>3. public/JS/dashboard_usuario.js</h2>
                    <p>En este archivo se han realizado cambios para mejorar la navegaci√≥n entre secciones del dashboard y gestionar los estados de pago del usuario. Ahora, el sistema permite al usuario navegar din√°micamente entre las pesta√±as, y maneja los par√°metros de pago de la URL para mostrar mensajes relacionados con el estado del pago (exitoso o cancelado).</p>
                    
                    <h3>3.1. Inicializaci√≥n de Pagos</h3>
                    <p>Se ha a√±adido la inicializaci√≥n de la gesti√≥n de pagos dentro del dashboard. Esto se hace llamando a <code>dashboardPayments.init()</code> para preparar el sistema para la carga y visualizaci√≥n de pagos.</p>
                    
                    <h3>3.2. Navegaci√≥n entre Pesta√±as</h3>
                    <p>Se ha implementado la l√≥gica para que el usuario pueda navegar entre las diferentes pesta√±as del dashboard. Al hacer clic en una pesta√±a, la interfaz se actualiza para reflejar la secci√≥n activa, proporcionando una experiencia de usuario m√°s din√°mica.</p>
                    
                    <h3>3.3. Manejo de Par√°metros de Pago en la URL</h3>
                    <p>Cuando el usuario es redirigido desde Stripe despu√©s de realizar un pago, se han a√±adido verificaciones para comprobar el estado del pago. Dependiendo de si el pago fue exitoso o cancelado, se muestra un mensaje correspondiente al usuario y se limpia la URL para evitar la visualizaci√≥n de par√°metros sensibles.</p>
                    
                    <h2>4. public/main.html</h2>
                    <p>En este archivo se han realizado modificaciones relacionadas con la visualizaci√≥n de pagos en el dashboard del usuario. Se ha a√±adido una nueva secci√≥n para mostrar los pagos realizados, con la opci√≥n de ordenarlos por fecha o cantidad. Adem√°s, se ha agregado un mensaje que se muestra cuando no hay pagos disponibles.</p>
                    
                    <h3>4.1. Secci√≥n de Pagos</h3>
                    <p>Se ha a√±adido una nueva secci√≥n de pagos al archivo <code>main.html</code>, donde los usuarios pueden ver todos los pagos asociados a sus facturas. Esta secci√≥n permite ordenar los pagos por fecha o por cantidad. Si no hay pagos registrados, se muestra un mensaje indic√°ndole al usuario que cuando realice pagos, estos aparecer√°n aqu√≠.</p>
                    
                    <h3>4.2. Filtros para Ordenar Pagos</h3>
                    <p>Dentro de la nueva secci√≥n de pagos, se ha a√±adido un selector que permite al usuario ordenar los pagos por <strong>Fecha de Pago</strong> o <strong>Cantidad</strong>. Adem√°s, el sistema permite invertir el orden de la lista, con un bot√≥n que alterna entre los modos ascendente y descendente.</p>
                </div>
            </div>
        </div>

        <div class="chapter-nav">
            <div class="prev">
                <a href="capitulo13.html">
                    <span class="nav-label">‚Üê Anterior</span>
                    <span class="nav-title">Cap√≠tulo 13: M√≥dulos Front Pagos</span>
                </a>
            </div>
            <div class="next">
                <a href="capitulo15.html">
                    <span class="nav-label">Siguiente ‚Üí</span>
                    <span class="nav-title">Cap√≠tulo 15: Backend Notificaciones</span>
                </a>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <p>üìö Material educativo para aprender desarrollo full-stack moderno</p>
            <p>Basado en el proyecto <a href="https://github.com/GCousido/ClutchPay" target="_blank">ClutchPay</a></p>
        </div>
    </footer>
</body>
</html>